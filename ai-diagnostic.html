<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>FocusMate AI Diagnostic Tool</title>
    <meta http-equiv="origin-trial" content="eyJvcmlnaW4iOiJodHRwczovL2ZvY3VzbWF0ZS10YXUudmVyY2VsLmFwcCIsImZlYXR1cmUiOiJBSVByb21wdEFQSU11bHRpbW9kYWxJbnB1dCIsImV4cGlyeSI6MTc3NjIwNjQzNSwiaXNTdWJkb21haW4iOnRydWV9">
    <meta http-equiv="origin-trial" content="eyJvcmlnaW4iOiJodHRwczovL2ZvY3VzbWF0ZS10YXUudmVyY2VsLmFwcCIsImZlYXR1cmUiOiJBSVN1bW1hcml6YXRpb25BUEkiLCJleHBpcnkiOjE3NzYyMDY0MzUsImlzU3ViZG9tYWluIjp0cnVlfQ==">
    <meta http-equiv="origin-trial" content="eyJvcmlnaW4iOiJodHRwczovL2ZvY3VzbWF0ZS10YXUudmVyY2VsLmFwcCIsImZlYXR1cmUiOiJBSVJld3JpdGVyQVBJIiwiZXhwaXJ5IjoxNzc2MjA2NDM1LCJpc1N1YmRvbWFpbiI6dHJ1ZX0=">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4f46e5, #7c3aed);
            color: white;
            padding: 40px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header p {
            font-size: 1.1rem;
            opacity: 0.9;
        }

        .content {
            padding: 40px;
        }

        .status-overview {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 40px;
        }

        .status-card {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            text-align: center;
            border: 2px solid #e2e8f0;
            transition: all 0.3s ease;
        }

        .status-card.pass {
            border-color: #10b981;
            background: #ecfdf5;
        }

        .status-card.fail {
            border-color: #ef4444;
            background: #fef2f2;
        }

        .status-card.warning {
            border-color: #f59e0b;
            background: #fffbeb;
        }

        .status-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .status-title {
            font-weight: 600;
            margin-bottom: 5px;
        }

        .status-message {
            font-size: 0.9rem;
            color: #64748b;
        }

        .section {
            margin-bottom: 40px;
        }

        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            margin-bottom: 20px;
            color: #1e293b;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .check-item {
            background: #f8fafc;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 15px;
            border-left: 4px solid #e2e8f0;
        }

        .check-item.pass {
            border-left-color: #10b981;
            background: #ecfdf5;
        }

        .check-item.fail {
            border-left-color: #ef4444;
            background: #fef2f2;
        }

        .check-item.warning {
            border-left-color: #f59e0b;
            background: #fffbeb;
        }

        .check-header {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 10px;
        }

        .check-title {
            font-weight: 600;
            flex: 1;
        }

        .check-message {
            color: #64748b;
            margin-bottom: 10px;
        }

        .check-details {
            font-size: 0.9rem;
            color: #64748b;
            margin-bottom: 15px;
            font-style: italic;
        }

        .fix-instructions {
            background: #1e293b;
            color: white;
            padding: 15px;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .fix-instructions h4 {
            margin-bottom: 10px;
            color: #fbbf24;
        }

        .fix-instructions ol {
            margin-left: 20px;
        }

        .fix-instructions li {
            margin-bottom: 5px;
        }

        .test-results {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
        }

        .test-card {
            background: #f8fafc;
            border-radius: 12px;
            padding: 20px;
            border: 2px solid #e2e8f0;
        }

        .test-card.success {
            border-color: #10b981;
            background: #ecfdf5;
        }

        .test-card.failure {
            border-color: #ef4444;
            background: #fef2f2;
        }

        .recommendations {
            background: linear-gradient(135deg, #fef3c7, #fbbf24);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 30px;
        }

        .recommendations h3 {
            color: #92400e;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .recommendations ul {
            color: #92400e;
            margin-left: 20px;
        }

        .recommendations li {
            margin-bottom: 8px;
        }

        .actions {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-top: 30px;
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-weight: 600;
            cursor: pointer;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 8px;
            transition: all 0.3s ease;
        }

        .btn-primary {
            background: #4f46e5;
            color: white;
        }

        .btn-primary:hover {
            background: #4338ca;
            transform: translateY(-2px);
        }

        .btn-secondary {
            background: #6b7280;
            color: white;
        }

        .btn-secondary:hover {
            background: #4b5563;
        }

        .btn-success {
            background: #10b981;
            color: white;
        }

        .btn-success:hover {
            background: #059669;
        }

        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #4f46e5;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .quick-links {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin-top: 30px;
        }

        .quick-link {
            background: #f8fafc;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            padding: 15px;
            text-decoration: none;
            color: #374151;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .quick-link:hover {
            border-color: #4f46e5;
            background: #f0f4ff;
            transform: translateY(-2px);
        }

        .copy-btn {
            background: #6b7280;
            color: white;
            border: none;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            cursor: pointer;
            margin-left: 10px;
        }

        .copy-btn:hover {
            background: #4b5563;
        }

        @media (max-width: 768px) {
            .container {
                margin: 10px;
                border-radius: 15px;
            }

            .header {
                padding: 30px 20px;
            }

            .header h1 {
                font-size: 2rem;
            }

            .content {
                padding: 20px;
            }

            .actions {
                flex-direction: column;
            }

            .btn {
                justify-content: center;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🔧 FocusMate AI Diagnostic Tool</h1>
            <p>Comprehensive Chrome AI feature detection and troubleshooting</p>
        </div>

        <div class="content">
            <div class="loading" id="loading">
                <div class="spinner"></div>
                <p>Running comprehensive AI diagnostics...</p>
            </div>

            <div id="results" style="display: none;">
                <!-- Status Overview -->
                <div class="section">
                    <h2 class="section-title">📊 Status Overview</h2>
                    <div class="status-overview" id="statusOverview">
                        <!-- Status cards will be populated here -->
                    </div>
                </div>

                <!-- Recommendations -->
                <div class="recommendations" id="recommendations" style="display: none;">
                    <h3>💡 Recommendations</h3>
                    <ul id="recommendationsList">
                        <!-- Recommendations will be populated here -->
                    </ul>
                </div>

                <!-- Detailed Checks -->
                <div class="section">
                    <h2 class="section-title">🔍 Detailed Checks</h2>
                    <div id="detailedChecks">
                        <!-- Detailed checks will be populated here -->
                    </div>
                </div>

                <!-- Functional Tests -->
                <div class="section">
                    <h2 class="section-title">🧪 Functional Tests</h2>
                    <div class="test-results" id="testResults">
                        <!-- Test results will be populated here -->
                    </div>
                </div>

                <!-- Actions -->
                <div class="actions">
                    <button class="btn btn-primary" onclick="runDiagnostics()">
                        🔄 Run Diagnostics Again
                    </button>
                    <button class="btn btn-secondary" onclick="copyResults()">
                        📋 Copy Results
                    </button>
                    <a href="index.html" class="btn btn-success">
                        🏠 Back to FocusMate
                    </a>
                </div>

                <!-- Quick Links -->
                <div class="quick-links">
                    <a href="chrome://flags" class="quick-link" target="_blank">
                        🚩 Chrome Flags
                    </a>
                    <a href="chrome://components" class="quick-link" target="_blank">
                        📦 Chrome Components
                    </a>
                    <a href="chrome://settings/help" class="quick-link" target="_blank">
                        ℹ️ Chrome Version
                    </a>
                    <a href="chrome://on-device-internals" class="quick-link" target="_blank">
                        🔧 AI Internals
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // Import the diagnostic utility (inline version for standalone HTML)
        
        // Inline diagnostic functions (simplified version)
        async function runDiagnostics() {
            document.getElementById('loading').style.display = 'block';
            document.getElementById('results').style.display = 'none';

            // Simulate diagnostic delay
            await new Promise(resolve => setTimeout(resolve, 1000));

            const results = await performDiagnostics();
            displayResults(results);

            document.getElementById('loading').style.display = 'none';
            document.getElementById('results').style.display = 'block';
        }

        async function performDiagnostics() {
            const checks = {
                chromeVersion: checkChromeVersion(),
                browserType: checkBrowserType(),
                aiObject: checkAIObject(),
                summarizerAPI: checkSummarizerAPI(),
                translatorAPI: checkTranslatorAPI(),
                modelStatus: await checkModelStatus(),
                originTokens: checkOriginTokens(),
                domain: checkDomain()
            };

            const testResults = await runFunctionalTests();
            const overallStatus = determineOverallStatus(checks);
            const recommendations = generateRecommendations(checks, testResults);

            return {
                overallStatus,
                checks,
                recommendations,
                testResults
            };
        }

        function checkChromeVersion() {
            const userAgent = navigator.userAgent;
            const chromeMatch = userAgent.match(/Chrome\/(\d+)/);
            const version = chromeMatch ? parseInt(chromeMatch[1]) : 0;

            if (version === 0) {
                return {
                    status: 'fail',
                    message: 'Chrome version not detected',
                    details: `User agent: ${userAgent}`,
                    fixInstructions: ['Install Google Chrome browser']
                };
            }

            if (version < 138) {
                return {
                    status: 'fail',
                    message: `Chrome version ${version} is too old`,
                    details: 'Chrome AI requires version 138 or later',
                    fixInstructions: [
                        'Go to chrome://settings/help',
                        'Click "Update Google Chrome" if available',
                        'Or download from https://www.google.com/chrome/',
                        'Restart Chrome after updating'
                    ]
                };
            }

            return {
                status: 'pass',
                message: `Chrome version ${version} is supported`,
                details: 'Meets minimum requirement of Chrome 138+'
            };
        }

        function checkBrowserType() {
            const userAgent = navigator.userAgent;
            const isChrome = userAgent.includes('Chrome') && !userAgent.includes('Edg');
            const isEdge = userAgent.includes('Edg');
            const isFirefox = userAgent.includes('Firefox');
            const isSafari = userAgent.includes('Safari') && !userAgent.includes('Chrome');

            if (isChrome) {
                return {
                    status: 'pass',
                    message: 'Chrome browser detected',
                    details: 'Chrome AI features are supported'
                };
            }

            let browserName = 'Unknown';
            if (isEdge) browserName = 'Microsoft Edge';
            else if (isFirefox) browserName = 'Mozilla Firefox';
            else if (isSafari) browserName = 'Safari';

            return {
                status: 'fail',
                message: `${browserName} browser detected`,
                details: 'Chrome AI features require Google Chrome',
                fixInstructions: [
                    'Install Google Chrome browser',
                    'Or integrate OpenAI/Claude API for universal browser support'
                ]
            };
        }

        function checkAIObject() {
            const hasAI = 'ai' in self;
            
            if (!hasAI) {
                return {
                    status: 'fail',
                    message: 'AI object not available',
                    details: 'self.ai is undefined',
                    fixInstructions: [
                        'Ensure Chrome 138+ is installed',
                        'Enable AI features in chrome://flags',
                        'Restart Chrome after enabling flags'
                    ]
                };
            }

            const aiObject = self.ai;
            if (!aiObject) {
                return {
                    status: 'fail',
                    message: 'AI object is null',
                    details: 'self.ai exists but is null',
                    fixInstructions: [
                        'Enable AI features in chrome://flags',
                        'Download AI model in chrome://components',
                        'Restart Chrome'
                    ]
                };
            }

            return {
                status: 'pass',
                message: 'AI object is available',
                details: 'self.ai exists and is accessible'
            };
        }

        function checkSummarizerAPI() {
            const chromeAI = self.ai;
            
            if (!chromeAI) {
                return {
                    status: 'fail',
                    message: 'AI object not available',
                    details: 'Cannot check Summarizer API without AI object'
                };
            }

            const hasSummarizer = !!chromeAI.summarizer;
            
            if (!hasSummarizer) {
                return {
                    status: 'fail',
                    message: 'Summarizer API not available',
                    details: 'chromeAI.summarizer is undefined',
                    fixInstructions: [
                        'Enable #summarization-api-for-gemini-nano in chrome://flags',
                        'Download AI model in chrome://components',
                        'Restart Chrome'
                    ]
                };
            }

            return {
                status: 'pass',
                message: 'Summarizer API is available',
                details: 'chromeAI.summarizer is accessible'
            };
        }

        function checkTranslatorAPI() {
            const chromeAI = self.ai;
            
            if (!chromeAI) {
                return {
                    status: 'fail',
                    message: 'AI object not available',
                    details: 'Cannot check Translator API without AI object'
                };
            }

            const hasTranslator = !!chromeAI.translator;
            
            if (!hasTranslator) {
                return {
                    status: 'warning',
                    message: 'Translator API not available',
                    details: 'chromeAI.translator is undefined (optional)',
                    fixInstructions: [
                        'Enable #prompt-api-for-gemini-nano in chrome://flags',
                        'Download AI model in chrome://components'
                    ]
                };
            }

            return {
                status: 'pass',
                message: 'Translator API is available',
                details: 'chromeAI.translator is accessible'
            };
        }

        async function checkModelStatus() {
            try {
                const chromeAI = self.ai;
                
                if (!chromeAI?.summarizer) {
                    return {
                        status: 'fail',
                        message: 'Cannot check model status',
                        details: 'Summarizer API not available'
                    };
                }

                const capabilities = await chromeAI.summarizer.capabilities();
                
                if (capabilities.available === 'readily') {
                    return {
                        status: 'pass',
                        message: 'AI model is downloaded and ready',
                        details: 'Model is available for immediate use'
                    };
                } else if (capabilities.available === 'after-download') {
                    return {
                        status: 'warning',
                        message: 'AI model needs to be downloaded',
                        details: 'Model will be downloaded on first use (2GB)',
                        fixInstructions: [
                            'Go to chrome://components',
                            'Find "Optimization Guide On Device Model"',
                            'Click "Check for update"',
                            'Wait for download to complete (5-30 minutes)'
                        ]
                    };
                } else {
                    return {
                        status: 'fail',
                        message: 'AI model is not available',
                        details: 'Model download failed or not supported',
                        fixInstructions: [
                            'Check system requirements (22GB storage, 4GB+ VRAM)',
                            'Go to chrome://components to retry download',
                            'Ensure stable internet connection'
                        ]
                    };
                }
            } catch (error) {
                return {
                    status: 'fail',
                    message: 'Error checking model status',
                    details: error.message || 'Unknown error',
                    fixInstructions: [
                        'Check if AI model is downloaded in chrome://components',
                        'Verify model status in chrome://on-device-internals'
                    ]
                };
            }
        }

        function checkOriginTokens() {
            const metaTags = document.querySelectorAll('meta[http-equiv="origin-trial"]');
            const tokens = Array.from(metaTags).map(tag => tag.getAttribute('content'));
            
            if (tokens.length === 0) {
                return {
                    status: 'fail',
                    message: 'No origin trial tokens found',
                    details: 'Missing origin trial tokens in HTML head',
                    fixInstructions: [
                        'Add origin trial tokens to HTML head',
                        'Generate tokens at https://developer.chrome.com/origintrials',
                        'Include tokens for your domain'
                    ]
                };
            }

            const validTokens = tokens.filter(token => token && token.length > 0);
            
            if (validTokens.length === 0) {
                return {
                    status: 'fail',
                    message: 'Origin trial tokens are empty',
                    details: 'Tokens exist but are empty or invalid'
                };
            }

            return {
                status: 'pass',
                message: `${validTokens.length} origin trial token(s) found`,
                details: 'Origin trial tokens are configured'
            };
        }

        function checkDomain() {
            const hostname = window.location.hostname;
            const isLocalhost = hostname === 'localhost' || hostname === '127.0.0.1';
            const isVercel = hostname.includes('vercel.app');
            const isHTTPS = window.location.protocol === 'https:';

            if (isLocalhost) {
                return {
                    status: 'pass',
                    message: 'Localhost development environment',
                    details: `Domain: ${hostname} (development)`
                };
            }

            if (isVercel && isHTTPS) {
                return {
                    status: 'pass',
                    message: 'Vercel production environment',
                    details: `Domain: ${hostname} (HTTPS)`
                };
            }

            if (!isHTTPS) {
                return {
                    status: 'warning',
                    message: 'Non-HTTPS domain detected',
                    details: `Domain: ${hostname} (HTTP)`,
                    fixInstructions: [
                        'Chrome AI features work best on HTTPS domains',
                        'Consider deploying to HTTPS'
                    ]
                };
            }

            return {
                status: 'pass',
                message: 'Custom domain detected',
                details: `Domain: ${hostname}`
            };
        }

        async function runFunctionalTests() {
            const summarizerTest = await testSummarizer();
            const translatorTest = await testTranslator();

            return { summarizerTest, translatorTest };
        }

        async function testSummarizer() {
            const startTime = Date.now();
            
            try {
                const chromeAI = self.ai;
                
                if (!chromeAI?.summarizer) {
                    return {
                        success: false,
                        message: 'Summarizer API not available',
                        error: 'chromeAI.summarizer is undefined'
                    };
                }

                const summarizer = await chromeAI.summarizer.create({
                    type: 'key-points',
                    format: 'plain-text',
                    length: 'short'
                });

                const result = await summarizer.summarize('This is a test sentence for AI summarization.');
                const duration = Date.now() - startTime;

                if (result && result.length > 0) {
                    return {
                        success: true,
                        message: 'Summarizer test passed',
                        duration
                    };
                } else {
                    return {
                        success: false,
                        message: 'Summarizer returned empty result',
                        duration
                    };
                }
            } catch (error) {
                return {
                    success: false,
                    message: 'Summarizer test failed',
                    duration: Date.now() - startTime,
                    error: error.message || 'Unknown error'
                };
            }
        }

        async function testTranslator() {
            const startTime = Date.now();
            
            try {
                const chromeAI = self.ai;
                
                if (!chromeAI?.translator) {
                    return {
                        success: false,
                        message: 'Translator API not available',
                        error: 'chromeAI.translator is undefined'
                    };
                }

                const translator = await chromeAI.translator.create({
                    sourceLanguage: 'en',
                    targetLanguage: 'es'
                });

                const result = await translator.translate('Hello world');
                const duration = Date.now() - startTime;

                if (result && result.length > 0) {
                    return {
                        success: true,
                        message: 'Translator test passed',
                        duration
                    };
                } else {
                    return {
                        success: false,
                        message: 'Translator returned empty result',
                        duration
                    };
                }
            } catch (error) {
                return {
                    success: false,
                    message: 'Translator test failed',
                    duration: Date.now() - startTime,
                    error: error.message || 'Unknown error'
                };
            }
        }

        function determineOverallStatus(checks) {
            const criticalChecks = [checks.chromeVersion, checks.browserType, checks.aiObject, checks.summarizerAPI];
            const hasFailures = criticalChecks.some(check => check.status === 'fail');
            const hasWarnings = Object.values(checks).some(check => check.status === 'warning');

            if (hasFailures) return 'fail';
            if (hasWarnings) return 'partial';
            return 'pass';
        }

        function generateRecommendations(checks, testResults) {
            const recommendations = [];

            if (checks.chromeVersion.status === 'fail') {
                recommendations.push('Update Chrome to version 138 or later');
            }

            if (checks.browserType.status === 'fail') {
                recommendations.push('Switch to Google Chrome browser');
            }

            if (checks.aiObject.status === 'fail') {
                recommendations.push('Enable AI features in chrome://flags and restart Chrome');
            }

            if (checks.summarizerAPI.status === 'fail') {
                recommendations.push('Enable #summarization-api-for-gemini-nano flag');
            }

            if (checks.modelStatus.status === 'warning' || checks.modelStatus.status === 'fail') {
                recommendations.push('Download AI model in chrome://components (2GB download)');
            }

            if (checks.originTokens.status === 'fail') {
                recommendations.push('Add origin trial tokens to HTML head');
            }

            if (!testResults.summarizerTest.success) {
                recommendations.push('Test summarizer functionality - may need model download');
            }

            if (!testResults.translatorTest.success) {
                recommendations.push('Test translator functionality - may need additional setup');
            }

            return recommendations;
        }

        function displayResults(results) {
            // Display status overview
            displayStatusOverview(results.overallStatus, results.checks);
            
            // Display recommendations
            displayRecommendations(results.recommendations);
            
            // Display detailed checks
            displayDetailedChecks(results.checks);
            
            // Display test results
            displayTestResults(results.testResults);
        }

        function displayStatusOverview(overallStatus, checks) {
            const overview = document.getElementById('statusOverview');
            overview.innerHTML = '';

            const statusConfig = {
                pass: { icon: '✅', color: 'pass', text: 'All Systems Ready' },
                partial: { icon: '⚠️', color: 'warning', text: 'Some Issues Found' },
                fail: { icon: '❌', color: 'fail', text: 'Setup Required' }
            };

            const config = statusConfig[overallStatus];
            
            overview.innerHTML = `
                <div class="status-card ${config.color}">
                    <div class="status-icon">${config.icon}</div>
                    <div class="status-title">Overall Status</div>
                    <div class="status-message">${config.text}</div>
                </div>
                <div class="status-card ${checks.chromeVersion.status}">
                    <div class="status-icon">${checks.chromeVersion.status === 'pass' ? '✅' : checks.chromeVersion.status === 'warning' ? '⚠️' : '❌'}</div>
                    <div class="status-title">Chrome Version</div>
                    <div class="status-message">${checks.chromeVersion.message}</div>
                </div>
                <div class="status-card ${checks.aiObject.status}">
                    <div class="status-icon">${checks.aiObject.status === 'pass' ? '✅' : checks.aiObject.status === 'warning' ? '⚠️' : '❌'}</div>
                    <div class="status-title">AI Object</div>
                    <div class="status-message">${checks.aiObject.message}</div>
                </div>
                <div class="status-card ${checks.summarizerAPI.status}">
                    <div class="status-icon">${checks.summarizerAPI.status === 'pass' ? '✅' : checks.summarizerAPI.status === 'warning' ? '⚠️' : '❌'}</div>
                    <div class="status-title">Summarizer API</div>
                    <div class="status-message">${checks.summarizerAPI.message}</div>
                </div>
            `;
        }

        function displayRecommendations(recommendations) {
            const container = document.getElementById('recommendations');
            const list = document.getElementById('recommendationsList');
            
            if (recommendations.length === 0) {
                container.style.display = 'none';
                return;
            }

            list.innerHTML = recommendations.map(rec => `<li>${rec}</li>`).join('');
            container.style.display = 'block';
        }

        function displayDetailedChecks(checks) {
            const container = document.getElementById('detailedChecks');
            container.innerHTML = '';

            Object.entries(checks).forEach(([key, check]) => {
                const checkElement = document.createElement('div');
                checkElement.className = `check-item ${check.status}`;
                
                const icon = check.status === 'pass' ? '✅' : check.status === 'warning' ? '⚠️' : '❌';
                
                let fixInstructionsHTML = '';
                if (check.fixInstructions && check.fixInstructions.length > 0) {
                    fixInstructionsHTML = `
                        <div class="fix-instructions">
                            <h4>Fix Instructions:</h4>
                            <ol>
                                ${check.fixInstructions.map(instruction => `<li>${instruction}</li>`).join('')}
                            </ol>
                        </div>
                    `;
                }

                checkElement.innerHTML = `
                    <div class="check-header">
                        <span class="status-icon">${icon}</span>
                        <span class="check-title">${check.message}</span>
                    </div>
                    <div class="check-message">${check.details || ''}</div>
                    ${fixInstructionsHTML}
                `;
                
                container.appendChild(checkElement);
            });
        }

        function displayTestResults(testResults) {
            const container = document.getElementById('testResults');
            
            container.innerHTML = `
                <div class="test-card ${testResults.summarizerTest.success ? 'success' : 'failure'}">
                    <h3>🧠 Summarizer Test</h3>
                    <p><strong>Status:</strong> ${testResults.summarizerTest.success ? '✅ Passed' : '❌ Failed'}</p>
                    <p><strong>Message:</strong> ${testResults.summarizerTest.message}</p>
                    ${testResults.summarizerTest.duration ? `<p><strong>Duration:</strong> ${testResults.summarizerTest.duration}ms</p>` : ''}
                    ${testResults.summarizerTest.error ? `<p><strong>Error:</strong> ${testResults.summarizerTest.error}</p>` : ''}
                </div>
                <div class="test-card ${testResults.translatorTest.success ? 'success' : 'failure'}">
                    <h3>🌐 Translator Test</h3>
                    <p><strong>Status:</strong> ${testResults.translatorTest.success ? '✅ Passed' : '❌ Failed'}</p>
                    <p><strong>Message:</strong> ${testResults.translatorTest.message}</p>
                    ${testResults.translatorTest.duration ? `<p><strong>Duration:</strong> ${testResults.translatorTest.duration}ms</p>` : ''}
                    ${testResults.translatorTest.error ? `<p><strong>Error:</strong> ${testResults.translatorTest.error}</p>` : ''}
                </div>
            `;
        }

        function copyResults() {
            const results = document.getElementById('results').innerText;
            navigator.clipboard.writeText(results).then(() => {
                alert('Results copied to clipboard!');
            }).catch(() => {
                alert('Failed to copy results. Please select and copy manually.');
            });
        }

        // Make functions global for onclick handlers
        window.runDiagnostics = runDiagnostics;
        window.copyResults = copyResults;

        // Run diagnostics on page load
        document.addEventListener('DOMContentLoaded', runDiagnostics);
    </script>
</body>
</html>

